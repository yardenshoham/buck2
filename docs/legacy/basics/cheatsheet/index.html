<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-legacy/basics/cheatsheet">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Buck Cheat Sheet | Buck2</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/legacy/basics/cheatsheet/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Buck Cheat Sheet | Buck2"><meta data-rh="true" name="description" content="This section provides example command lines that you can use to obtain information about Buck and about your build. These techniques can help you to understand how your build works and to troubleshoot issues with your build."><meta data-rh="true" property="og:description" content="This section provides example command lines that you can use to obtain information about Buck and about your build. These techniques can help you to understand how your build works and to troubleshoot issues with your build."><link data-rh="true" rel="icon" href="/img/logo.png"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/legacy/basics/cheatsheet/"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/legacy/basics/cheatsheet/" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/legacy/basics/cheatsheet/" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GEGGHE39PE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-GEGGHE39PE",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.96950b1b.css">
<link rel="preload" href="/assets/js/runtime~main.e94ab9dd.js" as="script">
<link rel="preload" href="/assets/js/main.71de8834.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Buck2</b></a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/docs/api/rules/">Rules</a><a class="navbar__item navbar__link" href="/docs/api/">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/buck2" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Buck Cheat Sheet</h1><p>This section provides example command lines that you can use to obtain information about Buck and about your build. These techniques can help you to understand how your build works and to troubleshoot issues with your build.
Most of these examples use the <a href="https://buck.build/command/query.html" target="_blank" rel="noopener noreferrer"><code>buck query</code></a>, <a href="https://buck.build/command/targets.html" target="_blank" rel="noopener noreferrer"><code>buck targets</code></a>, and <a href="https://buck.build/command/audit.html" target="_blank" rel="noopener noreferrer"><code>buck audit</code></a> commands. For more information and examples, see the reference pages for those commands.</p><hr><ul><li>How do I get a list of all the rules that Buck supports from the command line?</li><li>How do I see the arguments for a given rule from the command line?</li><li>How do I find all the targets for a package?</li><li>How do I specify more than one target to buck query?</li><li>How do I get the attribute names and values for the targets that result from a query?</li><li>How do I perform a query inside of a rule?</li><li>How do I find the dependencies for a target, that is, the targets on which a specified target depends?</li><li>How do I find the reverse-dependencies for a target, that is, the targets that depend on a specified target?</li><li>How do I find the build file that contains the target that owns a source file?</li></ul><hr><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-get-a-list-of-all-the-rules-that-buck-supports-from-the-command-line-so-that-i-can-process-them-with-grep-sed-etc">How do I get a list of all the rules that Buck supports,<strong> *</strong>from the command line*, so that I can process them with** <strong><code>grep</code>,</strong> **<code>sed</code>, etc?<a href="#how-do-i-get-a-list-of-all-the-rules-that-buck-supports-from-the-command-line-so-that-i-can-process-them-with-grep-sed-etc" class="hash-link" aria-label="Direct link to how-do-i-get-a-list-of-all-the-rules-that-buck-supports-from-the-command-line-so-that-i-can-process-them-with-grep-sed-etc" title="Direct link to how-do-i-get-a-list-of-all-the-rules-that-buck-supports-from-the-command-line-so-that-i-can-process-them-with-grep-sed-etc">â€‹</a></h3><p>Use <a href="https://buck.build/command/audit.html" target="_blank" rel="noopener noreferrer"><code>buck audit</code></a> with the <code>ruletypes</code> (plural) subcommand, which returns an alphabetized list of all the rules that Buck supports.
The following command line uses <code>buck audit ruletypes</code> with the <code>grep</code> command to print all the build rules that have the string <code>android</code> in their names.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">buck audit ruletypes | grep android</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note that these are not all the rules that Buck provides for Android development. For example, the rules <code>apk_genrule</code> and <code>ndk_library</code> support Android development, but do not themselves contain the string <code>android</code> in their names.
How do I see the arguments for a rule from the command line?
Use <a href="https://buck.build/command/audit.html" target="_blank" rel="noopener noreferrer"><code>buck audit</code></a> with the <code>ruletype</code> (singular) subcommand followed by the name of the rule.
The following command line uses <code>buck audit ruletype</code> to view the arguments supported by the <a href="https://buck.build/rule/remote_file.html" target="_blank" rel="noopener noreferrer"><code>remote_file</code></a> rule.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">buck audit ruletype remote_file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def remote_file (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sha1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    labels = None,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    licenses = None,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    out = None,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type = None,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-find-all-the-targets-for-a-package">How do I find all the targets for a package?<a href="#how-do-i-find-all-the-targets-for-a-package" class="hash-link" aria-label="Direct link to How do I find all the targets for a package?" title="Direct link to How do I find all the targets for a package?">â€‹</a></h3><p>Specify a <em>build target pattern</em> that represents the targets in the package.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">buck query //path/to/dir/...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>buck query</code> command can accept a <a href="https://buck.build/concept/build_target_pattern.html" target="_blank" rel="noopener noreferrer">build target pattern</a> as a parameter. If you specify a build target pattern, Buck evaluates this pattern and shows all the build targets that match it.
How do I specify more than one target to** **<code>buck query</code>?
Use the <a href="https://buck.build/command/query.html#set" target="_blank" rel="noopener noreferrer"><code>buck query set()</code></a> operator.
The following command line returns the target <code>main</code> in the build file in the root of the Buck project and all the targets from the build file in the <code>myclass</code> subdirectory of the root.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">buck query &quot;set( &#x27;//:main&#x27; &#x27;//myclass:&#x27; )&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-get-the-attribute-names-and-values-for-the-targets-returned-by-a-query">How do I get the attribute names and values for the targets returned by a query?<a href="#how-do-i-get-the-attribute-names-and-values-for-the-targets-returned-by-a-query" class="hash-link" aria-label="Direct link to How do I get the attribute names and values for the targets returned by a query?" title="Direct link to How do I get the attribute names and values for the targets returned by a query?">â€‹</a></h3><p>Add the <code>--output-attributes</code> option to the command line, followed by regular expressions that represent the attributes of interest.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">buck query &quot;deps(//foo:bar)&quot; --output-attributes &#x27;name&#x27; &#x27;exported_headers&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>--output-attributes</code> option enables you to specify which attributes Buck should return. Instead of returning the names of the targets that match the query expression, Buck returns the names and values of the specified attributes for those targets in JSON format. Attributes are specified as regular expressions. For example, <code>&#x27;.*&#x27;</code> matches all attributes. See the <a href="https://buck.build/command/query.html#output-attributes" target="_blank" rel="noopener noreferrer">buck query page</a> for more details. The output for the example query above might look something like the following.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;//foo/bar/lib:lib&quot; : {&quot;exported_headers&quot; : [ &quot;App/util.h&quot; ],&quot;name&quot; : &quot;lib&quot;},&quot;//foo/bar:app&quot; : {&quot;exported_headers&quot; : [ &quot;App/lib.h&quot; ],&quot;name&quot; : &quot;app&quot;}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-perform-a-query-inside-of-a-rule">How do I perform a query<strong> *</strong>inside<strong>* </strong>of a rule?<a href="#how-do-i-perform-a-query-inside-of-a-rule" class="hash-link" aria-label="Direct link to how-do-i-perform-a-query-inside-of-a-rule" title="Direct link to how-do-i-perform-a-query-inside-of-a-rule">â€‹</a></h3><p>Use <a href="https://buck.build/function/string_parameter_macros.html" target="_blank" rel="noopener noreferrer"><strong>string parameter macros</strong></a>, specifically, the <em>query</em> macros:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$(query_targets &quot;queryfunction(//:foo)&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$(query_outputs &quot;queryfunction(//:foo)&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$(query_targets_and_outputs [SEPARATOR] &quot;queryfunction(//:foo)&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Note, however, that the query macros are supported only for <a href="https://buck.build/rule/genrule.html" target="_blank" rel="noopener noreferrer"><code>genrule</code></a> and <a href="https://buck.build/rule/apk_genrule.html" target="_blank" rel="noopener noreferrer"><code>apk_genrule</code></a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-find-the-dependencies-for-a-target">How do I find the dependencies for a target?<a href="#how-do-i-find-the-dependencies-for-a-target" class="hash-link" aria-label="Direct link to How do I find the dependencies for a target?" title="Direct link to How do I find the dependencies for a target?">â€‹</a></h3><p>Use the <code>deps()</code> operator.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">buck query &quot;deps(&#x27;//foo:bar&#x27;)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">buck query &quot;deps(&#x27;//foo:bar&#x27;, 1, first_order_deps())&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">buck query &quot;deps(set(&#x27;//foo:bar&#x27; &#x27;//foo:lib&#x27; &#x27;//foo/baz:util&#x27;))&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <a href="https://buck.build/command/query.html#deps" target="_blank" rel="noopener noreferrer">deps</a> operator finds the dependencies of the specified targets. The first argument represents the targets of interest. This can be a single <a href="https://buck.build/concept/build_target.html" target="_blank" rel="noopener noreferrer">build target</a> or <a href="https://buck.build/concept/build_target_pattern.html" target="_blank" rel="noopener noreferrer">build target pattern</a>, or a set of these.
The optional second argument is the <em>depth</em> of the search for dependencies from the specified targets. For example, <code>1</code>, as shown in the example above, returns only the direct dependencies. If you do not provide this argument, the output is the complete set of transitive dependencies.
How do I find the reverse-dependencies for a target, that is, the targets that<strong> *</strong>depend on<strong>* </strong>a specified target?
Use the <code>buck query</code> <a href="https://buck.build/command/query.html#rdeps" target="_blank" rel="noopener noreferrer"><code>rdeps</code></a> (reverse dependencies) operator.
The following example, returns the targets in the <a href="https://en.wikipedia.org/wiki/Transitive_closure" target="_blank" rel="noopener noreferrer">transitive closure</a> of <code>//foo:bar</code> that depend directly on <code>//example:baz</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">buck query &quot;rdeps(&#x27;//foo:bar&#x27;, &#x27;//example:baz&#x27;, 1)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-do-i-find-the-buildfile-that-contains-the-target-that-owns-a-source-file">How do I find the buildfile that contains the target that owns a source file?<a href="#how-do-i-find-the-buildfile-that-contains-the-target-that-owns-a-source-file" class="hash-link" aria-label="Direct link to How do I find the buildfile that contains the target that owns a source file?" title="Direct link to How do I find the buildfile that contains the target that owns a source file?">â€‹</a></h3><p>In order to find the build file associated with a source file, combine the <code>owner</code> operator with <code>buildfile</code>. For example,</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">buck query &quot;buildfile(owner(&#x27;foo/bar/main.cpp&#x27;))&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>first finds the targets that <em>own</em> <code>foo/bar/main.cpp</code> and then returns the build files, such as <code>foo/bar/BUCK</code>, that define those targets.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-do-i-get-a-list-of-all-the-rules-that-buck-supports-from-the-command-line-so-that-i-can-process-them-with-grep-sed-etc" class="table-of-contents__link toc-highlight">How do I get a list of all the rules that Buck supports,<strong> *</strong>from the command line*, so that I can process them with** <strong><code>grep</code>,</strong> **<code>sed</code>, etc?</a></li><li><a href="#how-do-i-find-all-the-targets-for-a-package" class="table-of-contents__link toc-highlight">How do I find all the targets for a package?</a></li><li><a href="#how-do-i-get-the-attribute-names-and-values-for-the-targets-returned-by-a-query" class="table-of-contents__link toc-highlight">How do I get the attribute names and values for the targets returned by a query?</a></li><li><a href="#how-do-i-perform-a-query-inside-of-a-rule" class="table-of-contents__link toc-highlight">How do I perform a query<strong> *</strong>inside<strong>* </strong>of a rule?</a></li><li><a href="#how-do-i-find-the-dependencies-for-a-target" class="table-of-contents__link toc-highlight">How do I find the dependencies for a target?</a></li><li><a href="#how-do-i-find-the-buildfile-that-contains-the-target-that-owns-a-source-file" class="table-of-contents__link toc-highlight">How do I find the buildfile that contains the target that owns a source file?</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">User guide</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/buck2/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/buck2" target="_blank" rel="noopener noreferrer" class="footer__link-item">Code<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e94ab9dd.js"></script>
<script src="/assets/js/main.71de8834.js"></script>
</body>
</html>