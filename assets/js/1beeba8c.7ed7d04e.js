"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[2648],{3905:(e,t,a)=>{a.r(t),a.d(t,{MDXContext:()=>p,MDXProvider:()=>m,mdx:()=>b,useMDXComponents:()=>u,withMDXComponents:()=>s});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},o.apply(this,arguments)}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var p=r.createContext({}),s=function(e){return function(t){var a=u(t.components);return r.createElement(e,o({},t,{components:a}))}},u=function(e){var t=r.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):d(d({},t),e)),a},m=function(e){var t=u(e.components);return r.createElement(p.Provider,{value:t},e.children)},h="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),s=u(a),m=n,h=s["".concat(i,".").concat(m)]||s[m]||c[m]||o;return a?r.createElement(h,d(d({ref:t},p),{},{components:a})):r.createElement(h,d({ref:t},p))}));function b(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=f;var d={};for(var l in t)hasOwnProperty.call(t,l)&&(d[l]=t[l]);d.originalType=e,d[h]="string"==typeof e?e:n,i[1]=d;for(var p=2;p<o;p++)i[p]=a[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}f.displayName="MDXCreateElement"},10920:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>d,toc:()=>p});var r=a(87462),n=(a(67294),a(3905));const o={},i="Buck Cheat Sheet",d={unversionedId:"legacy/basics/cheatsheet",id:"legacy/basics/cheatsheet",title:"Buck Cheat Sheet",description:"This section provides example command lines that you can use to obtain information about Buck and about your build. These techniques can help you to understand how your build works and to troubleshoot issues with your build.",source:"@site/../docs/legacy/basics/cheatsheet.md",sourceDirName:"legacy/basics",slug:"/legacy/basics/cheatsheet",permalink:"/docs/legacy/basics/cheatsheet",draft:!1,tags:[],version:"current",frontMatter:{}},l={},p=[{value:"How do I get a list of all the rules that Buck supports,<strong> *</strong>from the command line*, so that I can process them with** <strong><code>grep</code>,</strong> **<code>sed</code>, etc?",id:"how-do-i-get-a-list-of-all-the-rules-that-buck-supports-from-the-command-line-so-that-i-can-process-them-with-grep-sed-etc",level:3},{value:"How do I find all the targets for a package?",id:"how-do-i-find-all-the-targets-for-a-package",level:3},{value:"How do I get the attribute names and values for the targets returned by a query?",id:"how-do-i-get-the-attribute-names-and-values-for-the-targets-returned-by-a-query",level:3},{value:"How do I perform a query<strong> *</strong>inside<strong>* </strong>of a rule?",id:"how-do-i-perform-a-query-inside-of-a-rule",level:3},{value:"How do I find the dependencies for a target?",id:"how-do-i-find-the-dependencies-for-a-target",level:3},{value:"How do I find the buildfile that contains the target that owns a source file?",id:"how-do-i-find-the-buildfile-that-contains-the-target-that-owns-a-source-file",level:3}],s={toc:p};function u(e){let{components:t,...a}=e;return(0,n.mdx)("wrapper",(0,r.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,n.mdx)("h1",{id:"buck-cheat-sheet"},"Buck Cheat Sheet"),(0,n.mdx)("p",null,"This section provides example command lines that you can use to obtain information about Buck and about your build. These techniques can help you to understand how your build works and to troubleshoot issues with your build.\nMost of these examples use the ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/command/query.html"},(0,n.mdx)("inlineCode",{parentName:"a"},"buck query")),", ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/command/targets.html"},(0,n.mdx)("inlineCode",{parentName:"a"},"buck targets")),", and ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/command/audit.html"},(0,n.mdx)("inlineCode",{parentName:"a"},"buck audit"))," commands. For more information and examples, see the reference pages for those commands."),(0,n.mdx)("hr",null),(0,n.mdx)("ul",null,(0,n.mdx)("li",{parentName:"ul"},"How do I get a list of all the rules that Buck supports from the command line?"),(0,n.mdx)("li",{parentName:"ul"},"How do I see the arguments for a given rule from the command line?"),(0,n.mdx)("li",{parentName:"ul"},"How do I find all the targets for a package?"),(0,n.mdx)("li",{parentName:"ul"},"How do I specify more than one target to buck query?"),(0,n.mdx)("li",{parentName:"ul"},"How do I get the attribute names and values for the targets that result from a query?"),(0,n.mdx)("li",{parentName:"ul"},"How do I perform a query inside of a rule?"),(0,n.mdx)("li",{parentName:"ul"},"How do I find the dependencies for a target, that is, the targets on which a specified target depends?"),(0,n.mdx)("li",{parentName:"ul"},"How do I find the reverse-dependencies for a target, that is, the targets that depend on a specified target?"),(0,n.mdx)("li",{parentName:"ul"},"How do I find the build file that contains the target that owns a source file?")),(0,n.mdx)("hr",null),(0,n.mdx)("h3",{id:"how-do-i-get-a-list-of-all-the-rules-that-buck-supports-from-the-command-line-so-that-i-can-process-them-with-grep-sed-etc"},"How do I get a list of all the rules that Buck supports,",(0,n.mdx)("strong",{parentName:"h3"}," *"),"from the command line*, so that I can process them with** ",(0,n.mdx)("strong",{parentName:"h3"},(0,n.mdx)("inlineCode",{parentName:"strong"},"grep"),",")," **",(0,n.mdx)("inlineCode",{parentName:"h3"},"sed"),", etc?"),(0,n.mdx)("p",null,"Use ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/command/audit.html"},(0,n.mdx)("inlineCode",{parentName:"a"},"buck audit"))," with the ",(0,n.mdx)("inlineCode",{parentName:"p"},"ruletypes")," (plural) subcommand, which returns an alphabetized list of all the rules that Buck supports.\nThe following command line uses ",(0,n.mdx)("inlineCode",{parentName:"p"},"buck audit ruletypes")," with the ",(0,n.mdx)("inlineCode",{parentName:"p"},"grep")," command to print all the build rules that have the string ",(0,n.mdx)("inlineCode",{parentName:"p"},"android")," in their names."),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},"buck audit ruletypes | grep android\n")),(0,n.mdx)("p",null,"Note that these are not all the rules that Buck provides for Android development. For example, the rules ",(0,n.mdx)("inlineCode",{parentName:"p"},"apk_genrule")," and ",(0,n.mdx)("inlineCode",{parentName:"p"},"ndk_library")," support Android development, but do not themselves contain the string ",(0,n.mdx)("inlineCode",{parentName:"p"},"android")," in their names.\nHow do I see the arguments for a rule from the command line?\nUse ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/command/audit.html"},(0,n.mdx)("inlineCode",{parentName:"a"},"buck audit"))," with the ",(0,n.mdx)("inlineCode",{parentName:"p"},"ruletype")," (singular) subcommand followed by the name of the rule.\nThe following command line uses ",(0,n.mdx)("inlineCode",{parentName:"p"},"buck audit ruletype")," to view the arguments supported by the ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/rule/remote_file.html"},(0,n.mdx)("inlineCode",{parentName:"a"},"remote_file"))," rule."),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},"buck audit ruletype remote_file\ndef remote_file (\n    name,\n    sha1,\n    url,\n    labels = None,\n    licenses = None,\n    out = None,\n    type = None,\n):\n    ...\n")),(0,n.mdx)("h3",{id:"how-do-i-find-all-the-targets-for-a-package"},"How do I find all the targets for a package?"),(0,n.mdx)("p",null,"Specify a ",(0,n.mdx)("em",{parentName:"p"},"build target pattern")," that represents the targets in the package."),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},"buck query //path/to/dir/...\n")),(0,n.mdx)("p",null,"The ",(0,n.mdx)("inlineCode",{parentName:"p"},"buck query")," command can accept a ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/concept/build_target_pattern.html"},"build target pattern")," as a parameter. If you specify a build target pattern, Buck evaluates this pattern and shows all the build targets that match it.\nHow do I specify more than one target to** **",(0,n.mdx)("inlineCode",{parentName:"p"},"buck query"),"?\nUse the ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/command/query.html#set"},(0,n.mdx)("inlineCode",{parentName:"a"},"buck query set()"))," operator.\nThe following command line returns the target ",(0,n.mdx)("inlineCode",{parentName:"p"},"main")," in the build file in the root of the Buck project and all the targets from the build file in the ",(0,n.mdx)("inlineCode",{parentName:"p"},"myclass")," subdirectory of the root."),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},"buck query \"set( '//:main' '//myclass:' )\"\n")),(0,n.mdx)("h3",{id:"how-do-i-get-the-attribute-names-and-values-for-the-targets-returned-by-a-query"},"How do I get the attribute names and values for the targets returned by a query?"),(0,n.mdx)("p",null,"Add the ",(0,n.mdx)("inlineCode",{parentName:"p"},"--output-attributes")," option to the command line, followed by regular expressions that represent the attributes of interest."),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},"buck query \"deps(//foo:bar)\" --output-attributes 'name' 'exported_headers'\n")),(0,n.mdx)("p",null,"The ",(0,n.mdx)("inlineCode",{parentName:"p"},"--output-attributes")," option enables you to specify which attributes Buck should return. Instead of returning the names of the targets that match the query expression, Buck returns the names and values of the specified attributes for those targets in JSON format. Attributes are specified as regular expressions. For example, ",(0,n.mdx)("inlineCode",{parentName:"p"},"'.*'")," matches all attributes. See the ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/command/query.html#output-attributes"},"buck query page")," for more details. The output for the example query above might look something like the following."),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},'{"//foo/bar/lib:lib" : {"exported_headers" : [ "App/util.h" ],"name" : "lib"},"//foo/bar:app" : {"exported_headers" : [ "App/lib.h" ],"name" : "app"}}\n')),(0,n.mdx)("h3",{id:"how-do-i-perform-a-query-inside-of-a-rule"},"How do I perform a query",(0,n.mdx)("strong",{parentName:"h3"}," *"),"inside",(0,n.mdx)("strong",{parentName:"h3"},"* "),"of a rule?"),(0,n.mdx)("p",null,"Use ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/function/string_parameter_macros.html"},(0,n.mdx)("strong",{parentName:"a"},"string parameter macros")),", specifically, the ",(0,n.mdx)("em",{parentName:"p"},"query")," macros:"),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},'$(query_targets "queryfunction(//:foo)")\n$(query_outputs "queryfunction(//:foo)")\n$(query_targets_and_outputs [SEPARATOR] "queryfunction(//:foo)")\n')),(0,n.mdx)("p",null,"Note, however, that the query macros are supported only for ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/rule/genrule.html"},(0,n.mdx)("inlineCode",{parentName:"a"},"genrule"))," and ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/rule/apk_genrule.html"},(0,n.mdx)("inlineCode",{parentName:"a"},"apk_genrule")),"."),(0,n.mdx)("h3",{id:"how-do-i-find-the-dependencies-for-a-target"},"How do I find the dependencies for a target?"),(0,n.mdx)("p",null,"Use the ",(0,n.mdx)("inlineCode",{parentName:"p"},"deps()")," operator."),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},"buck query \"deps('//foo:bar')\"\nbuck query \"deps('//foo:bar', 1, first_order_deps())\"\nbuck query \"deps(set('//foo:bar' '//foo:lib' '//foo/baz:util'))\"\n")),(0,n.mdx)("p",null,"The ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/command/query.html#deps"},"deps")," operator finds the dependencies of the specified targets. The first argument represents the targets of interest. This can be a single ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/concept/build_target.html"},"build target")," or ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/concept/build_target_pattern.html"},"build target pattern"),", or a set of these.\nThe optional second argument is the ",(0,n.mdx)("em",{parentName:"p"},"depth")," of the search for dependencies from the specified targets. For example, ",(0,n.mdx)("inlineCode",{parentName:"p"},"1"),", as shown in the example above, returns only the direct dependencies. If you do not provide this argument, the output is the complete set of transitive dependencies.\nHow do I find the reverse-dependencies for a target, that is, the targets that",(0,n.mdx)("strong",{parentName:"p"}," *"),"depend on",(0,n.mdx)("strong",{parentName:"p"},"* "),"a specified target?\nUse the ",(0,n.mdx)("inlineCode",{parentName:"p"},"buck query")," ",(0,n.mdx)("a",{parentName:"p",href:"https://buck.build/command/query.html#rdeps"},(0,n.mdx)("inlineCode",{parentName:"a"},"rdeps"))," (reverse dependencies) operator.\nThe following example, returns the targets in the ",(0,n.mdx)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Transitive_closure"},"transitive closure")," of ",(0,n.mdx)("inlineCode",{parentName:"p"},"//foo:bar")," that depend directly on ",(0,n.mdx)("inlineCode",{parentName:"p"},"//example:baz"),"."),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},"buck query \"rdeps('//foo:bar', '//example:baz', 1)\"\n")),(0,n.mdx)("h3",{id:"how-do-i-find-the-buildfile-that-contains-the-target-that-owns-a-source-file"},"How do I find the buildfile that contains the target that owns a source file?"),(0,n.mdx)("p",null,"In order to find the build file associated with a source file, combine the ",(0,n.mdx)("inlineCode",{parentName:"p"},"owner")," operator with ",(0,n.mdx)("inlineCode",{parentName:"p"},"buildfile"),". For example,"),(0,n.mdx)("pre",null,(0,n.mdx)("code",{parentName:"pre"},"buck query \"buildfile(owner('foo/bar/main.cpp'))\"\n")),(0,n.mdx)("p",null,"first finds the targets that ",(0,n.mdx)("em",{parentName:"p"},"own")," ",(0,n.mdx)("inlineCode",{parentName:"p"},"foo/bar/main.cpp")," and then returns the build files, such as ",(0,n.mdx)("inlineCode",{parentName:"p"},"foo/bar/BUCK"),", that define those targets."))}u.isMDXComponent=!0}}]);